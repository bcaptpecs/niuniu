<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¿ä¸œçº¸ç‰Œç‰›ç‰› Â· ç½‘é¡µç‰ˆ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #1e4b3c 0%, #2a6e5a 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        .game-container {
            max-width: 950px;
            width: 100%;
            background: #f1e8d9;
            background-image: radial-gradient(circle at 20% 30%, #f8f0dd 2%, transparent 25%);
            border-radius: 48px 48px 32px 32px;
            box-shadow: 0 25px 40px rgba(0, 0, 0, 0.6), inset 2px 2px 5px #fff3dd, inset -3px -3px 8px #b59e7a;
            padding: 24px 20px 30px;
            border: 2px solid #cbb086;
        }
        h1 {
            text-align: center;
            margin: 0 0 12px 0;
            font-weight: 500;
            color: #faeac9;
            text-shadow: 2px 3px 0 #4a2e1e, 4px 5px 0 #00000022;
            font-size: 2.6rem;
            letter-spacing: 4px;
            word-break: keep-all;
        }
        .subtitle {
            text-align: center;
            color: #ecdba8;
            font-style: italic;
            margin-top: -10px;
            margin-bottom: 30px;
            font-weight: 300;
            text-shadow: 1px 1px 0 #3a2a1c;
        }
        .board {
            background: #2d5a4b;
            border-radius: 60px 60px 40px 40px;
            padding: 30px 20px 25px;
            box-shadow: inset 0 0 0 2px #8f7455, inset 0 0 15px #1e3a2e, 0 12px 10px rgba(0,0,0,0.3);
        }
        .hand-area {
            background: #1b4235;
            border-radius: 50px 50px 30px 30px;
            padding: 24px 12px 18px;
            margin-bottom: 30px;
            box-shadow: inset 0 2px 8px #4f826b, inset 0 -3px 5px #0d2b20;
        }
        .hand-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            padding-left: 16px;
        }
        .hand-label h2 {
            color: #fbe8b0;
            margin: 0;
            font-size: 1.8rem;
            font-weight: 400;
            text-shadow: 1px 2px 0 #3b5f48;
        }
        .hand-type {
            background: #2f2a1f;
            color: #ffd78c;
            padding: 6px 18px;
            border-radius: 40px;
            font-size: 1.2rem;
            font-weight: 500;
            letter-spacing: 1px;
            box-shadow: inset 0 1px 4px #bba477, 0 3px 0 #51442e;
        }
        .cards {
            display: flex;
            flex-wrap: nowrap;
            justify-content: flex-start;
            gap: 12px;
            padding: 8px 10px;
            min-height: 130px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }

        /* éšè—Webkitæµè§ˆå™¨çš„æ»šåŠ¨æ¡ */
        .cards::-webkit-scrollbar {
            display: none;
        }
        .card {
            background: #fcf9f2;
            width: 85px;
            height: 120px;
            border-radius: 12px;
            border: 2px solid #bfa37c;
            box-shadow: 0 8px 0 #6e4f33, 0 10px 12px black;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px 5px;
            font-weight: bold;
            transition: transform 0.15s;
            font-size: 1.5rem;
            position: relative;
        }
        .card[data-suit="â™ "] { color: #1f1f1f; }
        .card[data-suit="â™¥"] { color: #c12b2b; }
        .card[data-suit="â™£"] { color: #1f1f1f; }
        .card[data-suit="â™¦"] { color: #c12b2b; }
        .card .top-left {
            align-self: flex-start;
            line-height: 1;
        }
        .card .bottom-right {
            align-self: flex-end;
            transform: rotate(180deg);
            line-height: 1;
        }
        .card .suit-big {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            opacity: 0.25;
            color: #4a3a28;
        }
        .computer .card {
            background: #ecdbbd;
            border-color: #9b7f60;
        }
        .result-area {
            background: #3d2f1f;
            border-radius: 60px;
            padding: 20px 30px;
            margin: 15px 0 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            border: 3px solid #b2925e;
            box-shadow: inset 0 2px 5px #5f4d33;
        }
        .winner-box {
            font-size: 2rem;
            font-weight: 600;
            background: #f3cf92;
            padding: 8px 30px;
            border-radius: 40px;
            color: #2d4a35;
            box-shadow: 0 5px 0 #8f6d3f;
        }
        .detail-info {
            font-size: 1.3rem;
            color: #f0dbb0;
            display: flex;
            gap: 25px;
        }
        .deal-btn {
            background: #f5c542;
            border: none;
            font-size: 2rem;
            padding: 16px 40px;
            border-radius: 60px;
            font-weight: 600;
            color: #2e4a3b;
            box-shadow: 0 9px 0 #9e762b, 0 10px 20px black;
            cursor: pointer;
            transition: 0.05s linear;
            margin-top: 15px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            letter-spacing: 3px;
        }
        .deal-btn:active {
            transform: translateY(6px);
            box-shadow: 0 3px 0 #9e762b, 0 7px 12px black;
        }
        .footer-note {
            text-align: center;
            color: #b8a27b;
            margin-top: 16px;
            font-size: 0.95rem;
        }
        /* å‘ç‰ŒåŠ¨ç”» */
        .card.dealing {
            animation: dealCard 0.5s ease-out forwards;
            opacity: 0;
        }
        /* ç©å®¶ç‰Œä»å³ä¾§é£å…¥ */
        .hand-area:not(.computer) .card.dealing {
            transform: translateX(100px) translateY(-50px) rotate(10deg);
        }
        /* åº„å®¶ç‰Œä»å³ä¾§é£å…¥ */
        .hand-area.computer .card.dealing {
            transform: translateX(100px) translateY(-50px) rotate(15deg);
        }
        @keyframes dealCard {
            0% {
                opacity: 0;
            }
            70% {
                opacity: 1;
                transform: translateX(0) translateY(5px) rotate(0);
            }
            100% {
                opacity: 1;
                transform: translateX(0) translateY(0) rotate(0);
            }
        }

        @media (max-width: 650px) {
            .cards {
                gap: 6px;
                padding: 6px 8px;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
            }
            .card { width: 60px; height: 85px; font-size: 1.1rem; }
            .hand-label h2 { font-size: 1.3rem; }
            .winner-box { font-size: 1.5rem; padding: 5px 20px; }
            .detail-info { font-size: 1.1rem; gap: 15px; flex-wrap: wrap; }
            .deal-btn { font-size: 1.6rem; padding: 14px 30px; }
            .suit-big { font-size: 2rem; }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
                align-items: flex-start; /* å‚ç›´æ–¹å‘é¡¶éƒ¨å¯¹é½ */
                justify-content: center; /* æ°´å¹³æ–¹å‘å±…ä¸­ */
                min-height: 100vh; /* ç¡®ä¿è‡³å°‘å æ»¡å±å¹• */
            }
            .game-container {
                padding: 16px 12px 20px;
                border-radius: 32px 32px 24px 24px;
                max-width: 100%; /* ç§»é™¤æœ€å¤§å®½åº¦é™åˆ¶ */
                width: 100%; /* ç¡®ä¿å®½åº¦100% */
            }
            h1 { font-size: 2rem; letter-spacing: 2px; margin-bottom: 8px; }
            .subtitle { font-size: 0.9rem; margin-bottom: 20px; }
            .board { padding: 20px 12px 18px; border-radius: 40px 40px 28px 28px; }
            .hand-area { padding: 16px 8px 12px; margin-bottom: 20px; border-radius: 35px 35px 22px 22px; }
            .hand-label { margin-bottom: 10px; padding-left: 12px; }
            .hand-label h2 { font-size: 1.1rem; }
            .hand-type { font-size: 1rem; padding: 4px 12px; }
            .cards {
                gap: 5px;
                padding: 5px 6px;
                min-height: 100px;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
            }
            .card { width: 50px; height: 70px; font-size: 0.95rem; }
            .suit-big { font-size: 1.6rem; }
            .result-area { padding: 15px 18px; margin: 12px 0 8px; border-radius: 40px; flex-direction: column; align-items: center; gap: 10px; }
            .winner-box { font-size: 1.3rem; padding: 4px 16px; width: 100%; text-align: center; }
            .detail-info { font-size: 1rem; flex-direction: column; gap: 8px; text-align: center; }
            .deal-btn { font-size: 1.4rem; padding: 12px 24px; margin-top: 10px; letter-spacing: 2px; }
            .footer-note { font-size: 0.8rem; margin-top: 12px; }

            /* è°ƒæ•´å‘ç‰ŒåŠ¨ç”»èµ·ç‚¹è·ç¦» */
            .hand-area:not(.computer) .card.dealing,
            .hand-area.computer .card.dealing {
                transform: translateX(50px) translateY(-35px) rotate(8deg);
            }
        }

        @media (max-width: 360px) {
            body { padding: 6px; }
            .game-container { padding: 12px 8px 16px; }
            h1 { font-size: 1.7rem; margin-bottom: 6px; letter-spacing: 1px; }
            .subtitle { font-size: 0.8rem; margin-bottom: 15px; }
            .board { padding: 16px 8px 14px; }
            .hand-area { padding: 12px 5px 8px; margin-bottom: 15px; }
            .hand-label { margin-bottom: 8px; padding-left: 8px; }
            .hand-label h2 { font-size: 1rem; }
            .hand-type { font-size: 0.9rem; padding: 3px 10px; }
            .cards {
                gap: 4px;
                padding: 4px 5px;
                min-height: 90px;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
            }
            .card { width: 42px; height: 60px; font-size: 0.8rem; }
            .suit-big { font-size: 1.2rem; }
            .result-area { padding: 12px 14px; margin: 10px 0 6px; }
            .winner-box { font-size: 1.1rem; padding: 3px 12px; }
            .detail-info { font-size: 0.9rem; }
            .deal-btn { font-size: 1.1rem; padding: 9px 18px; margin-top: 8px; letter-spacing: 1px; }
            .footer-note { font-size: 0.75rem; margin-top: 10px; }

            /* è¿›ä¸€æ­¥å‡å°åŠ¨ç”»è·ç¦» */
            .hand-area:not(.computer) .card.dealing,
            .hand-area.computer .card.dealing {
                transform: translateX(35px) translateY(-25px) rotate(7deg);
            }
        }

        /* é’ˆå¯¹è¶…å°å±å¹•ï¼ˆå¦‚iPhone 5/SEï¼‰ */
        @media (max-width: 320px) {
            .board { padding: 14px 6px 12px; }
            .hand-area { margin-bottom: 8px; padding: 10px 5px 8px; }
            .cards {
                gap: 2px;
                padding: 3px 4px;
                min-height: 80px;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
            }
            .card { width: 36px; height: 52px; font-size: 0.7rem; }
            .suit-big { font-size: 1rem; }
            h1 { font-size: 1.3rem; margin-bottom: 4px; }
            .deal-btn { font-size: 0.85rem; padding: 6px 12px; margin-top: 6px; }

            /* è¿›ä¸€æ­¥å‡å°åŠ¨ç”»è·ç¦» */
            .hand-area:not(.computer) .card.dealing,
            .hand-area.computer .card.dealing {
                transform: translateX(25px) translateY(-20px) rotate(5deg);
            }
        }

        /* é’ˆå¯¹æçª„å±å¹•ï¼ˆå¦‚æŸäº›æ—§æ‰‹æœºï¼‰ */
        @media (max-width: 280px) {
            .board { padding: 12px 4px 10px; }
            .hand-area { padding: 8px 4px 6px; margin-bottom: 6px; }
            .cards {
                gap: 1px;
                padding: 2px 3px;
                min-height: 75px;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
            }
            .card { width: 32px; height: 46px; font-size: 0.65rem; }
            .suit-big { font-size: 0.9rem; }
            h1 { font-size: 1.2rem; }
            .hand-label h2 { font-size: 0.9rem; }
            .hand-type { font-size: 0.8rem; padding: 2px 8px; }
            .deal-btn { font-size: 0.8rem; padding: 5px 10px; margin-top: 5px; }
        }
    </style>
</head>
<body>
<div class="game-container">
    <h1>ğŸƒ å»£æ±ç‰›ç‰›</h1>
    <div class="subtitle">ä¸‰å¼µæ¹Šå Â· é¬¥å¤§å°</div>

    <div class="board">
        <!-- ç©å®¶åŒºåŸŸ -->
        <div class="hand-area">
            <div class="hand-label">
                <h2>ğŸ‘¤ ç©å®¶</h2>
                <span class="hand-type" id="player-type">ç­‰å¾…å‘ç‰Œ</span>
            </div>
            <div class="cards" id="player-cards">
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
            </div>
        </div>

        <!-- ç”µè„‘åŒºåŸŸ -->
        <div class="hand-area computer">
            <div class="hand-label">
                <h2>ğŸ¤– åº„å®¶</h2>
                <span class="hand-type" id="computer-type">ç­‰å¾…å‘ç‰Œ</span>
            </div>
            <div class="cards" id="computer-cards">
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
                <div class="card placeholder">?</div>
            </div>
        </div>

        <!-- ç»“æœæ  -->
        <div class="result-area" id="resultPanel">
            <div class="winner-box" id="winnerText">âš¡ å‘ç‰Œå§</div>
            <div class="detail-info" id="detailText"></div>
        </div>

        <button class="deal-btn" id="dealBtn">ğŸ€„ï¸ å‘ ç‰Œ</button>
    </div>
    <div class="footer-note">A=1ç‚¹ Â· J/Q/K=10ç‚¹ Â· äº”èŠ±ç‰›ï¼ç‚¸å¼¹ï¼äº”å°ç‰›ï¼ç‰›ç‰›ï¼æœ‰ç‰›ï¼æ— ç‰›</div>
</div>

<script>
    (function() {
        // ---------- ç‰Œåº“å®šä¹‰ ----------
        const SUITS = ['â™ ', 'â™¥', 'â™£', 'â™¦'];          // é»‘æ¡ƒ > çº¢å¿ƒ > æ¢…èŠ± > æ–¹å— (èŠ±è‰²å€¼ 4,3,2,1)
        const RANKS = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        // ç‚¹æ•° (ç”¨äºè®¡ç®—10å€æ•°) : A=1, 2~9=æ•°å€¼, 10,J,Q,K=10
        function getPoint(rank) {
            if (rank === 'A') return 1;
            if (rank === 'J' || rank === 'Q' || rank === 'K') return 10;
            return parseInt(rank, 10);
        }
        // é¢å€¼å¤§å° (ç”¨äºæ¯”å¤§å°) : A=1, 2=2 ... 10=10, J=11, Q=12, K=13
        function getFaceValue(rank) {
            if (rank === 'A') return 1;
            if (rank === 'J') return 11;
            if (rank === 'Q') return 12;
            if (rank === 'K') return 13;
            return parseInt(rank, 10);
        }
        // èŠ±è‰²æ•°å€¼
        function suitValue(suit) {
            return { 'â™ ': 4, 'â™¥': 3, 'â™£': 2, 'â™¦': 1 }[suit];
        }

        // åˆ›å»ºä¸€å‰¯æ–°ç‰Œ (52å¼ )
        function createDeck() {
            const deck = [];
            for (let s of SUITS) {
                for (let r of RANKS) {
                    deck.push({
                        suit: s,
                        rank: r,
                        point: getPoint(r),
                        face: getFaceValue(r),
                        suitVal: suitValue(s)
                    });
                }
            }
            return deck;
        }

        // Fisherâ€“Yates æ´—ç‰Œ
        function shuffle(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        // ---------- æ ¸å¿ƒè¯„ä¼°å‡½æ•° ----------
        // è¾“å…¥: 5å¼ ç‰Œçš„æ•°ç»„
        // è¾“å‡º: { type, level, compareInfo }   levelè¶Šé«˜è¶Šå¤§ï¼ŒcompareInfoä¸ºæ•°å­—æ•°ç»„ç”¨äºé€é¡¹æ¯”è¾ƒ
        function evaluateHand(hand) {
            // æ·±æ‹·è´ä¸€ä»½é˜²æ­¢å½±å“å¤–éƒ¨
            const cards = [...hand];

            // ---------- 1. æ£€æŸ¥ç‰¹æ®Šç‰Œå‹ ----------
            // äº”èŠ±ç‰›: äº”å¼ ç‰Œ rank éƒ½æ˜¯ J/Q/K
            const isWuhua = cards.every(c => c.rank === 'J' || c.rank === 'Q' || c.rank === 'K');
            if (isWuhua) {
                // æŒ‰é¢å€¼é™åº, ç„¶åå±•å¼€é¢å€¼+èŠ±è‰²å€¼
                const sorted = [...cards].sort((a, b) => (b.face - a.face) || (b.suitVal - a.suitVal));
                const compareInfo = [];
                for (let c of sorted) {
                    compareInfo.push(c.face, c.suitVal);
                }
                return { type: 'äº”èŠ±ç‰›', level: 7, compareInfo };
            }

            // ç‚¸å¼¹: å››å¼ ç›¸åŒ face
            const faceCount = new Map();
            cards.forEach(c => faceCount.set(c.face, (faceCount.get(c.face) || 0) + 1));
            let bombFace = null;
            let singleCard = null;
            for (let [face, cnt] of faceCount.entries()) {
                if (cnt === 4) bombFace = face;
                else if (cnt === 1) singleCard = cards.find(c => c.face === face);
            }
            if (bombFace !== null) {
                // å››å¼ ç›¸åŒ faceï¼ŒsingleCard æ˜¯å‰©ä¸‹çš„
                // æ¯”è¾ƒä¿¡æ¯: [ç‚¸å¼¹é¢å€¼, å•å¼ é¢å€¼, å•å¼ èŠ±è‰²å€¼]
                return {
                    type: 'ç‚¸å¼¹',
                    level: 6,
                    compareInfo: [bombFace, singleCard.face, singleCard.suitVal]
                };
            }

            // äº”å°ç‰›: æ‰€æœ‰ç‰Œ point â‰¤ 5 ä¸” æ€»point â‰¤ 10
            const totalPoint = cards.reduce((acc, c) => acc + c.point, 0);
            const allLe5 = cards.every(c => c.point <= 5);
            if (allLe5 && totalPoint <= 10) {
                // æŒ‰é¢å€¼é™åº (æ³¨æ„äº”å°ç‰›æ¯”è¾ƒæ—¶æ€»å’Œå°çš„èƒœ, æ‰€ä»¥ç”¨è´Ÿæ€»å’Œä½œä¸ºç¬¬ä¸€ä¼˜å…ˆçº§, ç„¶åè´Ÿçš„é¢å€¼é™åº)
                const sorted = [...cards].sort((a, b) => (b.face - a.face) || (b.suitVal - a.suitVal));
                const compareInfo = [-totalPoint];  // æ€»å’Œè¶Šå°ï¼Œè´Ÿå€¼è¶Šå¤§ï¼Œèƒœ
                for (let c of sorted) {
                    compareInfo.push(-c.face, c.suitVal); // æ³¨æ„ç”¨è´Ÿfaceï¼Œå› ä¸ºå¸Œæœ›å°faceèƒœ
                }
                return { type: 'äº”å°ç‰›', level: 5, compareInfo };
            }

            // ---------- 2. å¯»æ‰¾æœ€ä½³ç‰› (éç‰¹æ®Šç‰Œå‹) ----------
            // éå†æ‰€æœ‰ä¸‰å¼ ç»„åˆ C(5,3)=10
            let bestNiu = -1;               // -1è¡¨ç¤ºæ— ç‰›, 0~9ç‰›, 10ä¸ºç‰›ç‰›
            let bestRemaining = null;        // å‰©ä½™ä¸¤å¼ ç‰Œ (æŒ‰é¢å€¼é™åºæ’åˆ—çš„æ•°ç»„, æ¯é¡¹ä¿å­˜ face å’Œ suitVal)

            // è¾…åŠ©: æ¯”è¾ƒä¸¤ç»„å‰©ä½™ç‰Œ(å·²é™åº) è°æ›´å¤§ (ç”¨äºåŒç‰›æ•°é€‰æ›´å¼ºç»„åˆ)
            function isRemainingBetter(remA, remB) {
                for (let i = 0; i < 2; i++) {
                    if (remA[i].face > remB[i].face) return true;
                    if (remA[i].face < remB[i].face) return false;
                    if (remA[i].suitVal > remB[i].suitVal) return true;
                    if (remA[i].suitVal < remB[i].suitVal) return false;
                }
                return false; // å®Œå…¨ä¸€æ ·
            }

            const indices = [0,1,2,3,4];
            // æšä¸¾æ‰€æœ‰ä¸‰å¼ ç»„åˆ
            for (let i = 0; i < indices.length; i++) {
                for (let j = i+1; j < indices.length; j++) {
                    for (let k = j+1; k < indices.length; k++) {
                        const three = [cards[i], cards[j], cards[k]];
                        const sumThree = three.reduce((acc, c) => acc + c.point, 0);
                        if (sumThree % 10 !== 0) continue; // å¿…é¡»å‡‘æˆ10/20/30

                        // å‰©ä½™ä¸¤å¼ 
                        const remaining = cards.filter((_, idx) => idx !== i && idx !== j && idx !== k);
                        const sumTwo = remaining.reduce((acc, c) => acc + c.point, 0);
                        let niu = sumTwo % 10;
                        if (niu === 0) niu = 10; // ç‰›ç‰›

                        // å°†å‰©ä½™ä¸¤å¼ æŒ‰é¢å€¼é™åº (ä»¥ä¾¿æ¯”è¾ƒ)
                        const sortedRem = [...remaining].sort((a, b) => (b.face - a.face) || (b.suitVal - a.suitVal));

                        if (niu > bestNiu) {
                            bestNiu = niu;
                            bestRemaining = sortedRem;
                        } else if (niu === bestNiu && bestRemaining) {
                            // ç›¸åŒç‰›æ•°ï¼Œå–å‰©ä½™ç‰Œæ›´å¤§çš„ç»„åˆ
                            if (isRemainingBetter(sortedRem, bestRemaining)) {
                                bestRemaining = sortedRem;
                            }
                        }
                    }
                }
            }

            // æ— ç‰›æƒ…å†µ
            if (bestNiu === -1) {
                const sortedAll = [...cards].sort((a, b) => (b.face - a.face) || (b.suitVal - a.suitVal));
                const compareInfo = [];
                for (let c of sortedAll) {
                    compareInfo.push(c.face, c.suitVal);
                }
                return { type: 'æ— ç‰›', level: 2, compareInfo };
            }

            // æœ‰ç‰›: bestNiu 1~10 (10ä»£è¡¨ç‰›ç‰›)
            const typeStr = bestNiu === 10 ? 'ç‰›ç‰›' : `ç‰›${bestNiu}`;
            const level = 3 + (bestNiu / 10); // ç‰›10=4, ç‰›9=3.9, ç‰›1=3.1
            // compareInfo: å…ˆæ”¾ç‰›æ•°(10~1), å†æ”¾å‰©ä½™ä¸¤å¼ çš„faceå’Œsuit (å·²é™åº)
            const compareInfo = [bestNiu];
            for (let c of bestRemaining) {
                compareInfo.push(c.face, c.suitVal);
            }
            return { type: typeStr, level, compareInfo };
        }

        // æ¯”è¾ƒä¸¤æ‰‹ç‰Œ, è¿”å› 1: handAèµ¢, -1: handBèµ¢, 0:å¹³
        function compareHands(handA, handB) {
            const scoreA = evaluateHand(handA);
            const scoreB = evaluateHand(handB);
            if (scoreA.level > scoreB.level) return 1;
            if (scoreA.level < scoreB.level) return -1;

            // levelç›¸åŒ é€é¡¹æ¯”è¾ƒcompareInfo
            for (let i = 0; i < Math.min(scoreA.compareInfo.length, scoreB.compareInfo.length); i++) {
                if (scoreA.compareInfo[i] > scoreB.compareInfo[i]) return 1;
                if (scoreA.compareInfo[i] < scoreB.compareInfo[i]) return -1;
            }
            return 0; // å®Œå…¨ç›¸ç­‰
        }

        // ---------- æ¸²æŸ“æ‰‹ç‰Œåˆ°DOM ----------
        function renderCards(containerId, hand) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            hand.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card';
                cardDiv.setAttribute('data-suit', card.suit);
                cardDiv.innerHTML = `
                    <div class="top-left">${card.rank}<br>${card.suit}</div>
                    <div class="suit-big">${card.suit}</div>
                    <div class="bottom-right">${card.suit}<br>${card.rank}</div>
                `;
                container.appendChild(cardDiv);
            });
        }

        // æ›´æ–°UI: å‘ç‰Œå¹¶æ˜¾ç¤ºç»“æœï¼ˆå¸¦åŠ¨ç”»ï¼‰
        async function dealGame() {
            const dealBtn = document.getElementById('dealBtn');
            const winnerEl = document.getElementById('winnerText');
            const detailEl = document.getElementById('detailText');

            // ç¦ç”¨æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
            dealBtn.disabled = true;
            dealBtn.style.opacity = '0.6';

            // æ¸…ç©ºç»“æœåŒºåŸŸ
            winnerEl.innerText = 'ğŸƒ å‘ç‰Œä¸­...';
            detailEl.innerText = '';
            document.getElementById('player-type').innerText = 'ç­‰å¾…å‘ç‰Œ';
            document.getElementById('computer-type').innerText = 'ç­‰å¾…å‘ç‰Œ';

            // æ¸…ç©ºç‰Œæ¡Œ
            const playerContainer = document.getElementById('player-cards');
            const computerContainer = document.getElementById('computer-cards');
            playerContainer.innerHTML = '';
            computerContainer.innerHTML = '';

            // åˆ›å»ºå¹¶æ´—ç‰Œ
            const deck = shuffle(createDeck());
            const playerHand = deck.slice(0, 5);
            const computerHand = deck.slice(5, 10);

            // è¾…åŠ©å‡½æ•°ï¼šåˆ›å»ºä¸€å¼ ç‰Œå…ƒç´ å¹¶æ·»åŠ åˆ°å®¹å™¨
            function createCardElement(card) {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card dealing';
                cardDiv.setAttribute('data-suit', card.suit);
                cardDiv.innerHTML = `
                    <div class="top-left">${card.rank}<br>${card.suit}</div>
                    <div class="suit-big">${card.suit}</div>
                    <div class="bottom-right">${card.suit}<br>${card.rank}</div>
                `;
                return cardDiv;
            }

            // äº¤æ›¿å‘ç‰Œï¼šç©å®¶1 â†’ åº„å®¶1 â†’ ç©å®¶2 â†’ åº„å®¶2 ...
            async function dealCardsOneByOne() {
                for (let i = 0; i < 10; i++) {
                    const isPlayerTurn = i % 2 === 0; // å¶æ•°ç´¢å¼•å‘ç©å®¶ç‰Œï¼Œå¥‡æ•°å‘åº„å®¶ç‰Œ
                    const cardIndex = Math.floor(i / 2); // 0,0,1,1,2,2,3,3,4,4

                    if (isPlayerTurn) {
                        // å‘ç©å®¶ç‰Œ
                        const playerCard = playerHand[cardIndex];
                        const playerCardEl = createCardElement(playerCard);
                        playerContainer.appendChild(playerCardEl);
                    } else {
                        // å‘åº„å®¶ç‰Œ
                        const computerCard = computerHand[cardIndex];
                        const computerCardEl = createCardElement(computerCard);
                        computerContainer.appendChild(computerCardEl);
                    }

                    // æ¯å¼ ç‰Œé—´éš”2000æ¯«ç§’ï¼ŒåŠ å¿«ä¸€å€é€Ÿåº¦
                    await new Promise(resolve => setTimeout(resolve, 2000));
                }
            }

            // æ‰§è¡Œå‘ç‰Œ
            await dealCardsOneByOne();

            // ç­‰å¾…åŠ¨ç”»å®Œæˆï¼ˆåŠ¨ç”»æ—¶é•¿0.5ç§’ï¼Œå†ç­‰0.2ç§’ï¼‰
            await new Promise(resolve => setTimeout(resolve, 700));

            // è¯„ä¼°åŒæ–¹
            const playerScore = evaluateHand(playerHand);
            const computerScore = evaluateHand(computerHand);

            document.getElementById('player-type').innerText = playerScore.type;
            document.getElementById('computer-type').innerText = computerScore.type;

            const result = compareHands(playerHand, computerHand);
            let winnerStr = '';
            let detailStr = `ç©å®¶ ${playerScore.type}  vs  åº„å®¶ ${computerScore.type}`;
            if (result === 1) {
                winnerStr = 'ğŸ‰ ç©å®¶èµ¢ï¼';
            } else if (result === -1) {
                winnerStr = 'ğŸ’» åº„å®¶èµ¢';
            } else {
                winnerStr = 'âš–ï¸ å¹³å±€';
            }
            winnerEl.innerText = winnerStr;
            detailEl.innerText = detailStr;

            // æ¢å¤æŒ‰é’®
            dealBtn.disabled = false;
            dealBtn.style.opacity = '1';
        }

        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        document.getElementById('dealBtn').addEventListener('click', () => {
            dealGame();
        });

        // åˆå§‹åŒ–æ—¶è‡ªåŠ¨å‘ä¸€æ¬¡ç‰Œ
        window.addEventListener('load', () => {
            dealGame();
        });
    })();
</script>
</body>
</html>